{{ if .Vars.win2016cis_level_1 }}
command:
  eventlog_app_behaviour_when_max:
    {{ if .Vars.win2016cis_18_9_26_1_1 }}
    title: 18.9.26.1.1 | L1 | Ensure 'Application - Control Event Log behavior when the log file reaches its maximum size' is set to 'Disabled' | (SCORED) | reg_check
    exec: {{ .Vars.ps_regcheck }} get-itempropertyValue -path 'HKLM:/SOFTWARE/Policies/Microsoft/Windows/EventLog/Application' -Name Retention
    exit-status: 0
    stdout:
    - '0'
    {{ end }}
  eventlog_app_max_size:
    {{ if .Vars.win2016cis_18_9_26_1_2 }}
    title: 18.9.26.1.2 | L1 |  Ensure 'Application - Specify the maximum log file size (KB)' is set to 'Enabled - 32,768 or greater' | (SCORED) | reg_check
    exec: {{ .Vars.ps_regcheck }} get-itempropertyValue -path 'HKLM:/SOFTWARE/Policies/Microsoft/Windows/EventLog/Application' -Name MaxSize
    exit-status: 0
    stdout:
    - '{{ .Vars.win2016_eventlog_app_max_size }}'
    {{ end }}
{{ end }}
