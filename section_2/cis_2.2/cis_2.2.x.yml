{{ if .Vars.win2016cis_level_1 }}
command:
  access_cred_mgr:
    {{ if .Vars.win2016cis_2.2.1 }}
    title: 2.2.1 | L1 | Ensure 'Access Credential Manager as a trusted caller' is set to 'No One' | SCORED
    exec:
    exit-status: 0
    stdout:
    - 'No one'
    - '!/./'
    {{ end }}
  act_as_OS:
    {{ if .Vars.win2016cis_2.2.4 }}
    title: 2.2.2 | L1 | Ensure 'Act as part of the operating system' is set to 'No One' | SCORED
    exec:
    exit-status: 0
    stdout:
    - 'No One'
    - '!/./'
    {{ end }}
  mem_quotas_for_proc:
    {{ if .Vars.win2016cis_2.2.6 }}
    title: 2.2.6 | L1 | Ensure 'Adjust memory quotas for a process' is set to 'Administrators, LOCAL SERVICE, NETWORK SERVICE'  | SCORED
    exec:
    exit-status: 0
    stdout:
    - 'Administrators, LOCAL SERVICE, NETWORK SERVICE'
    - '!/./'
    {{ end }}
    passwd_complex:
    {{ if .Vars.win2016cis_1.1.5 }}
    title: 1.1.5 | L1 |  Ensure 'Password must meet complexity requirements'| SCORED
    exec:
    exit-status: 0
    stdout:
    - '/[14:100]/'
    {{ end }}
  passwd_rev_encrpyt:
    {{ if .Vars.win2016cis_1.1.6 }}
    title: 1.1.6 | L1 | Ensure 'Store passwords using reversible encryption' is set to 'Disabled' | SCORED
    exec:
    exit-status: 0
    stdout:
    - '1'
    {{ end }}
{{ end }}